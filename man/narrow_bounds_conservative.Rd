% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bounds.R
\name{narrow_bounds_conservative}
\alias{narrow_bounds_conservative}
\title{Conservative Quantile-Based Bound Narrowing}
\usage{
narrow_bounds_conservative(
  history,
  bounds,
  original_bounds = bounds,
  quantile_range = c(0.05, 0.95),
  min_width_frac = 0.3,
  min_feasible = 10,
  soften_threshold = 0.1,
  soften_factor = 0.5,
  verbose = TRUE
)
}
\arguments{
\item{history}{Data frame from previous BO stage with columns including
parameter values and `feasible` (logical)}

\item{bounds}{Current bounds (named list, each element: c(lower, upper))}

\item{original_bounds}{Original wide bounds for minimum width calculation
(default: same as bounds)}

\item{quantile_range}{Numeric vector of length 2: quantiles to use for
narrowing (default: c(0.05, 0.95))}

\item{min_width_frac}{Numeric: minimum width as fraction of original bounds
(default: 0.30 = at least 30% of original range)}

\item{min_feasible}{Integer: minimum feasible designs required before
narrowing is applied (default: 10)}

\item{soften_threshold}{Numeric: if feasible rate < this threshold, soften
the narrowing (default: 0.10 = 10%)}

\item{soften_factor}{Numeric: blend factor when softening - 0 = no narrowing,
1 = full narrowing (default: 0.5)}

\item{verbose}{Logical: print narrowing details?}
}
\value{
List with:
  \describe{
    \item{bounds}{Narrowed bounds (named list)}
    \item{narrowed}{Logical: whether any narrowing was applied}
    \item{diagnostics}{List with narrowing decision details:
      n_total, n_feasible, feasible_rate, softened, params_narrowed,
      params_skipped, reason_skipped}
  }
}
\description{
Narrows parameter bounds based on observed feasible designs, with safeguards:
- Uses quantiles (not min/max) to avoid over-narrowing from outliers
- Enforces minimum width relative to original bounds
- Requires minimum number of feasible designs before narrowing
- Softens narrowing when feasible rate is low
- Boundary-aware expansion when clamping reduces width
}
\examples{
\dontrun{
# After Stage 1 BO
history_s1 <- fit_s1$history

# Narrow bounds for Stage 2
result <- narrow_bounds_conservative(
  history = history_s1,
  bounds = bounds_wide,
  original_bounds = bounds_wide,
  min_width_frac = 0.30,
  min_feasible = 10
)

if (result$narrowed) {
  bounds_s2 <- result$bounds
}
}
}
